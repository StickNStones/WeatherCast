import sys
from requests import get
import calendar
import time
import json
from datetime import datetime
from dateutil import tz
import sqlite3


# Use these for full thing. Using imperial and hardcoded values for now for convience

coords = ["53.501192,-113.571222","51.0447,-114.0719", "34.052235,-118.243683", "38.912723,1.423821", "25.187290,55.282905", "-27.466200,153.025120", "52.367909,4.882993"]
city = ["loc", "Calgary", "LA", "Ibiza", "Dubai", "Brisbane", "Amsterdam"]

places = {"loc": "53.501192,-113.571222", "Calgary": "51.0447,-114.0719", "LA": "34.052235,-118.243683", "Ibiza": "38.912723,1.423821", "Dubai": "25.187290,55.282905",
            "Brisbane": "-27.466200,153.025120", "Amsterdam": "52.367909,4.882993"}

weatherStats = json.loads(get("https://api.darksky.net/forecast/cdf7237903b8bbe464da79d58bb6cd86/53.501192,-113.571222?units=ca").text)
#print(weatherStats)
#weatherStats = json.loads(weatherStats)

conn = sqlite3.connect('./database.db')
for key, value in places.items():
    weatherStats = json.loads(get("https://api.darksky.net/forecast/cdf7237903b8bbe464da79d58bb6cd86/"+ value + "?units=ca").text)
    sql_create_loc_table = "CREATE TABLE IF NOT EXISTS " + key + """ (
                                        date text PRIMARY KEY,
                                        temp0 integer,
                                        precip0 integer,
                                        temp1 integer,
                                        precip1 integer,
                                        temp2 integer,
                                        precip2 integer,
                                        temp3 integer,
                                        precip3 integer,
                                        temp4 integer,
                                        precip4 integer,
                                        temp5 integer,
                                        precip5 integer,
                                        temp6 integer,
                                        precip6 integer,
                                        temp7 integer,
                                        precip7 integer
                                    );"""


    #turn this into a building thing with loops and statements.
    sql_insert_replace_item = "insert or replace into " + key + """ (date, temp0, precipReal, temp1, precip1, temp2, precip2,
                                        temp3, precip3, temp4, precip4, temp5, precip5, temp6, precip6, temp7, precip7 ) values (
                                        (select date from loc where date = "date"),
                                        "SearchName",
                                        5,
                                        6,
                                        (select precip7 from  where Name = "SearchName"));""" # this statements saves the info

    sql_insert_replace_item = "insert or replace into " + key + """ (date, temp0, precip0, temp1, precip1, temp2, precip2,
                                        temp3, precip3, temp4, precip4, temp5, precip5, temp6, precip6, temp7, precip7 ) values ( """

    c = conn.cursor()
    c.execute(sql_create_loc_table)


    a = time.strftime("%a, %d %b %Y %H:%M:%S", time.localtime())
    #weatherStats = {"latitude":53.501192,"longitude":-113.571222,"timezone":"America/Edmonton","currently":{"time":1563425337,"summary":"Light Rain","icon":"rain","nearestStormDistance":0,"precipIntensity":0.023,"precipProbability":1,"precipType":"rain","temperature":58.52,"apparentTemperature":58.52,"dewPoint":54.05,"humidity":0.85,"pressure":999.42,"windSpeed":4.42,"windGust":10.3,"windBearing":10,"cloudCover":0.7,"uvIndex":0,"visibility":10,"ozone":336.8},"hourly":{"summary":"Light rain throughout the day.","icon":"rain","data":[{"time":1563422400,"summary":"Light Rain","icon":"rain","precipIntensity":0.018,"precipProbability":1,"precipType":"rain","temperature":60.08,"apparentTemperature":60.08,"dewPoint":54.67,"humidity":0.82,"pressure":999.48,"windSpeed":6.24,"windGust":16.17,"windBearing":338,"cloudCover":0.75,"uvIndex":0,"visibility":10,"ozone":335},{"time":1563426000,"summary":"Light Rain","icon":"rain","precipIntensity":0.024,"precipProbability":1,"precipType":"rain","temperature":58.17,"apparentTemperature":58.17,"dewPoint":53.9,"humidity":0.86,"pressure":999.41,"windSpeed":4.01,"windGust":8.97,"windBearing":14,"cloudCover":0.69,"uvIndex":0,"visibility":10,"ozone":337.2},{"time":1563429600,"summary":"Light Rain","icon":"rain","precipIntensity":0.025,"precipProbability":0.96,"precipType":"rain","temperature":56.98,"apparentTemperature":56.98,"dewPoint":53.37,"humidity":0.88,"pressure":999.1,"windSpeed":2.65,"windGust":4.39,"windBearing":34,"cloudCover":0.65,"uvIndex":0,"visibility":10,"ozone":339.5},{"time":1563433200,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.019,"precipProbability":0.52,"precipType":"rain","temperature":58.03,"apparentTemperature":58.03,"dewPoint":53.62,"humidity":0.85,"pressure":997.77,"windSpeed":2.78,"windGust":4.89,"windBearing":94,"cloudCover":0.71,"uvIndex":0,"visibility":10,"ozone":342.4},{"time":1563436800,"summary":"Mostly Cloudy","icon":"partly-cloudy-night","precipIntensity":0.011,"precipProbability":0.24,"precipType":"rain","temperature":58.52,"apparentTemperature":58.52,"dewPoint":53.71,"humidity":0.84,"pressure":996.89,"windSpeed":3.62,"windGust":7.75,"windBearing":264,"cloudCover":0.73,"uvIndex":0,"visibility":9.13,"ozone":345.3},{"time":1563440400,"summary":"Mostly Cloudy","icon":"partly-cloudy-night","precipIntensity":0.006,"precipProbability":0.17,"precipType":"rain","temperature":57.61,"apparentTemperature":57.61,"dewPoint":53.44,"humidity":0.86,"pressure":996.81,"windSpeed":4.58,"windGust":10.59,"windBearing":259,"cloudCover":0.69,"uvIndex":0,"visibility":7.152,"ozone":348},{"time":1563444000,"summary":"Mostly Cloudy","icon":"partly-cloudy-night","precipIntensity":0.003,"precipProbability":0.15,"precipType":"rain","temperature":56.56,"apparentTemperature":56.56,"dewPoint":53.32,"humidity":0.89,"pressure":996.65,"windSpeed":5.74,"windGust":13.17,"windBearing":200,"cloudCover":0.68,"uvIndex":0,"visibility":8.432,"ozone":350.2},{"time":1563447600,"summary":"Mostly Cloudy","icon":"partly-cloudy-night","precipIntensity":0.002,"precipProbability":0.14,"precipType":"rain","temperature":55.91,"apparentTemperature":55.91,"dewPoint":53.3,"humidity":0.91,"pressure":996.47,"windSpeed":7.21,"windGust":15.93,"windBearing":4,"cloudCover":0.68,"uvIndex":0,"visibility":10,"ozone":351.9},{"time":1563451200,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0.002,"precipProbability":0.19,"precipType":"rain","temperature":55.7,"apparentTemperature":55.7,"dewPoint":53.26,"humidity":0.91,"pressure":996.33,"windSpeed":8.53,"windGust":18.07,"windBearing":293,"cloudCover":0.68,"uvIndex":0,"visibility":10,"ozone":353.3},{"time":1563454800,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0.003,"precipProbability":0.22,"precipType":"rain","temperature":55.98,"apparentTemperature":55.98,"dewPoint":53.2,"humidity":0.9,"pressure":996.3,"windSpeed":9.18,"windGust":18.92,"windBearing":289,"cloudCover":0.69,"uvIndex":0,"visibility":10,"ozone":354.1},{"time":1563458400,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0.007,"precipProbability":0.3,"precipType":"rain","temperature":56.92,"apparentTemperature":56.92,"dewPoint":53.22,"humidity":0.87,"pressure":996.31,"windSpeed":9.61,"windGust":19.3,"windBearing":288,"cloudCover":0.71,"uvIndex":1,"visibility":10,"ozone":354.4},{"time":1563462000,"summary":"Possible Drizzle","icon":"rain","precipIntensity":0.012,"precipProbability":0.36,"precipType":"rain","temperature":57.9,"apparentTemperature":57.9,"dewPoint":53.14,"humidity":0.84,"pressure":996.33,"windSpeed":10.45,"windGust":20.97,"windBearing":284,"cloudCover":0.74,"uvIndex":1,"visibility":10,"ozone":354},{"time":1563465600,"summary":"Possible Drizzle","icon":"rain","precipIntensity":0.012,"precipProbability":0.35,"precipType":"rain","temperature":58.32,"apparentTemperature":58.32,"dewPoint":52.82,"humidity":0.82,"pressure":996.31,"windSpeed":12.33,"windGust":25.43,"windBearing":277,"cloudCover":0.78,"uvIndex":2,"visibility":10,"ozone":352.3},{"time":1563469200,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.02,"precipProbability":0.44,"precipType":"rain","temperature":58.6,"apparentTemperature":58.6,"dewPoint":52.41,"humidity":0.8,"pressure":996.28,"windSpeed":14.64,"windGust":31.03,"windBearing":292,"cloudCover":0.84,"uvIndex":3,"visibility":6.521,"ozone":349.9},{"time":1563472800,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.034,"precipProbability":0.56,"precipType":"rain","temperature":58.29,"apparentTemperature":58.29,"dewPoint":52.03,"humidity":0.8,"pressure":996.35,"windSpeed":16.42,"windGust":35.16,"windBearing":291,"cloudCover":0.89,"uvIndex":4,"visibility":3.8,"ozone":348.9},{"time":1563476400,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.047,"precipProbability":0.61,"precipType":"rain","temperature":58.07,"apparentTemperature":58.07,"dewPoint":51.52,"humidity":0.79,"pressure":996.53,"windSpeed":17.38,"windGust":36.74,"windBearing":291,"cloudCover":0.93,"uvIndex":4,"visibility":2.783,"ozone":351},{"time":1563480000,"summary":"Light Rain","icon":"rain","precipIntensity":0.061,"precipProbability":0.65,"precipType":"rain","temperature":57.48,"apparentTemperature":57.48,"dewPoint":50.86,"humidity":0.79,"pressure":996.81,"windSpeed":17.87,"windGust":36.98,"windBearing":292,"cloudCover":0.97,"uvIndex":4,"visibility":2.762,"ozone":354.5},{"time":1563483600,"summary":"Light Rain","icon":"rain","precipIntensity":0.069,"precipProbability":0.65,"precipType":"rain","temperature":57.02,"apparentTemperature":57.02,"dewPoint":50.33,"humidity":0.78,"pressure":997.17,"windSpeed":18.21,"windGust":36.91,"windBearing":292,"cloudCover":1,"uvIndex":3,"visibility":3.534,"ozone":356.6},{"time":1563487200,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.058,"precipProbability":0.62,"precipType":"rain","temperature":56.98,"apparentTemperature":56.98,"dewPoint":50.16,"humidity":0.78,"pressure":997.72,"windSpeed":18.43,"windGust":36.8,"windBearing":291,"cloudCover":1,"uvIndex":3,"visibility":5.699,"ozone":356.3},{"time":1563490800,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.041,"precipProbability":0.55,"precipType":"rain","temperature":57.38,"apparentTemperature":57.38,"dewPoint":50.17,"humidity":0.77,"pressure":998.38,"windSpeed":18.46,"windGust":36.39,"windBearing":291,"cloudCover":1,"uvIndex":2,"visibility":8.819,"ozone":354.6},{"time":1563494400,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.03,"precipProbability":0.52,"precipType":"rain","temperature":57.52,"apparentTemperature":57.52,"dewPoint":50.16,"humidity":0.76,"pressure":998.91,"windSpeed":18.44,"windGust":35.47,"windBearing":290,"cloudCover":1,"uvIndex":2,"visibility":10,"ozone":352.4},{"time":1563498000,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.026,"precipProbability":0.54,"precipType":"rain","temperature":58.17,"apparentTemperature":58.17,"dewPoint":49.99,"humidity":0.74,"pressure":999.15,"windSpeed":18.73,"windGust":33.78,"windBearing":290,"cloudCover":1,"uvIndex":1,"visibility":10,"ozone":349.8},{"time":1563501600,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.025,"precipProbability":0.52,"precipType":"rain","temperature":58.37,"apparentTemperature":58.37,"dewPoint":49.71,"humidity":0.73,"pressure":999.27,"windSpeed":19.24,"windGust":31.66,"windBearing":288,"cloudCover":0.99,"uvIndex":0,"visibility":9.495,"ozone":346.7},{"time":1563505200,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.028,"precipProbability":0.5,"precipType":"rain","temperature":58.03,"apparentTemperature":58.03,"dewPoint":49.53,"humidity":0.73,"pressure":999.48,"windSpeed":19.39,"windGust":29.87,"windBearing":288,"cloudCover":0.99,"uvIndex":0,"visibility":8.436,"ozone":343.8},{"time":1563508800,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.031,"precipProbability":0.52,"precipType":"rain","temperature":57.42,"apparentTemperature":57.42,"dewPoint":49.53,"humidity":0.75,"pressure":999.9,"windSpeed":18.54,"windGust":28.46,"windBearing":285,"cloudCover":0.99,"uvIndex":0,"visibility":7.495,"ozone":341.6},{"time":1563512400,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.036,"precipProbability":0.54,"precipType":"rain","temperature":56.5,"apparentTemperature":56.5,"dewPoint":49.69,"humidity":0.78,"pressure":1000.42,"windSpeed":17.12,"windGust":27.33,"windBearing":284,"cloudCover":0.99,"uvIndex":0,"visibility":6.5,"ozone":339.7},{"time":1563516000,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.039,"precipProbability":0.55,"precipType":"rain","temperature":55.79,"apparentTemperature":55.79,"dewPoint":49.87,"humidity":0.8,"pressure":1000.84,"windSpeed":15.81,"windGust":26.84,"windBearing":286,"cloudCover":0.99,"uvIndex":0,"visibility":6.05,"ozone":338.2},{"time":1563519600,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.039,
    #"precipProbability":0.57,"precipType":"rain","temperature":55.19,"apparentTemperature":55.19,"dewPoint":50.16,"humidity":0.83,"pressure":1001.05,"windSpeed":14.88,"windGust":27.63,"windBearing":300,"cloudCover":0.98,"uvIndex":0,"visibility":6.432,"ozone":337.4},{"time":1563523200,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.041,"precipProbability":0.58,"precipType":"rain","temperature":54.85,"apparentTemperature":54.85,"dewPoint":50.53,"humidity":0.85,"pressure":1001.17,"windSpeed":14.08,"windGust":29.1,"windBearing":291,"cloudCover":0.98,"uvIndex":0,"visibility":7.391,"ozone":337.1},{"time":1563526800,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.047,"precipProbability":0.58,"precipType":"rain","temperature":54.13,"apparentTemperature":54.13,"dewPoint":50.83,"humidity":0.89,"pressure":1001.31,"windSpeed":13.19,"windGust":29.84,"windBearing":302,"cloudCover":0.95,"uvIndex":0,"visibility":8.765,"ozone":336.9},{"time":1563530400,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.052,"precipProbability":0.58,"precipType":"rain","temperature":53.47,"apparentTemperature":53.47,"dewPoint":50.8,"humidity":0.91,"pressure":1001.53,"windSpeed":11.9,"windGust":29.26,"windBearing":309,"cloudCover":0.88,"uvIndex":0,"visibility":10,"ozone":336.8},{"time":1563534000,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.056,"precipProbability":0.56,"precipType":"rain","temperature":52.92,"apparentTemperature":52.92,"dewPoint":50.72,"humidity":0.92,"pressure":1001.79,"windSpeed":10.44,"windGust":28.04,"windBearing":334,"cloudCover":0.79,"uvIndex":0,"visibility":10,"ozone":336.6},{"time":1563537600,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.049,"precipProbability":0.52,"precipType":"rain","temperature":53.24,"apparentTemperature":53.24,"dewPoint":50.93,"humidity":0.92,"pressure":1002.1,"windSpeed":9.39,"windGust":26.58,"windBearing":332,"cloudCover":0.73,"uvIndex":0,"visibility":10,"ozone":336.7},{"time":1563541200,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.025,"precipProbability":0.47,"precipType":"rain","temperature":53.91,"apparentTemperature":53.91,"dewPoint":51.55,"humidity":0.92,"pressure":1002.46,"windSpeed":9.13,"windGust":24.8,"windBearing":335,"cloudCover":0.75,"uvIndex":0,"visibility":10,"ozone":337.1},{"time":1563544800,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0.005,"precipProbability":0.28,"precipType":"rain","temperature":55.7,"apparentTemperature":55.7,"dewPoint":52.41,"humidity":0.89,"pressure":1002.89,"windSpeed":9.33,"windGust":22.88,"windBearing":338,"cloudCover":0.79,"uvIndex":1,"visibility":10,"ozone":337.6},{"time":1563548400,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0.001,"precipProbability":0.21,"precipType":"rain","temperature":57.78,"apparentTemperature":57.78,"dewPoint":53.47,"humidity":0.86,"pressure":1003.31,"windSpeed":9.61,"windGust":21.64,"windBearing":343,"cloudCover":0.81,"uvIndex":1,"visibility":10,"ozone":338},{"time":1563552000,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0.003,"precipProbability":0.22,"precipType":"rain","temperature":60.85,"apparentTemperature":60.85,"dewPoint":55.03,"humidity":0.81,"pressure":1003.71,"windSpeed":9.86,"windGust":21.35,"windBearing":353,"cloudCover":0.77,"uvIndex":2,"visibility":10,"ozone":337.9},{"time":1563555600,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0.011,"precipProbability":0.27,"precipType":"rain","temperature":64.54,"apparentTemperature":64.54,"dewPoint":56.8,"humidity":0.76,"pressure":1004.11,"windSpeed":10.15,"windGust":21.53,"windBearing":6,"cloudCover":0.71,"uvIndex":3,"visibility":9.233,"ozone":337.4},{"time":1563559200,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.02,"precipProbability":0.32,"precipType":"rain","temperature":67.4,"apparentTemperature":67.4,"dewPoint":58.02,"humidity":0.72,"pressure":1004.48,"windSpeed":10.35,"windGust":21.73,"windBearing":18,"cloudCover":0.69,"uvIndex":4,"visibility":6.972,"ozone":337.3},{"time":1563562800,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.026,"precipProbability":0.36,"precipType":"rain","temperature":69.09,"apparentTemperature":69.09,"dewPoint":58.29,"humidity":0.69,"pressure":1004.77,"windSpeed":10.58,"windGust":21.95,"windBearing":29,"cloudCover":0.76,"uvIndex":4,"visibility":5.991,"ozone":337.7},{"time":1563566400,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.032,"precipProbability":0.34,"precipType":"rain","temperature":71.13,"apparentTemperature":71.13,"dewPoint":58.04,"humidity":0.63,"pressure":1005.01,"windSpeed":10.83,"windGust":22.17,"windBearing":39,"cloudCover":0.86,"uvIndex":4,"visibility":5.798,"ozone":338.3},{"time":1563570000,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.035,"precipProbability":0.34,"precipType":"rain","temperature":72.59,"apparentTemperature":72.59,"dewPoint":57.73,"humidity":0.6,"pressure":1005.39,"windSpeed":10.8,"windGust":21.83,"windBearing":40,"cloudCover":0.92,"uvIndex":4,"visibility":6.502,"ozone":338.8},{"time":1563573600,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.031,"precipProbability":0.32,"precipType":"rain","temperature":73.33,"apparentTemperature":73.33,"dewPoint":57.51,"humidity":0.58,"pressure":1005.92,"windSpeed":10.27,"windGust":20.65,"windBearing":30,"cloudCover":0.9,"uvIndex":3,"visibility":8.721,"ozone":339.4},{"time":1563577200,"summary":"Possible Light Rain","icon":"rain","precipIntensity":0.024,"precipProbability":0.3,"precipType":"rain","temperature":73.13,"apparentTemperature":73.13,"dewPoint":57.27,"humidity":0.58,"pressure":1006.56,"windSpeed":9.37,"windGust":18.8,"windBearing":14,"cloudCover":0.84,"uvIndex":3,"visibility":10,"ozone":339.9},{"time":1563580800,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0.018,"precipProbability":0.28,"precipType":"rain","temperature":72.58,"apparentTemperature":72.58,"dewPoint":57.1,"humidity":0.58,"pressure":1007.3,"windSpeed":8.46,"windGust":16.65,"windBearing":4,"cloudCover":0.77,"uvIndex":2,"visibility":10,"ozone":340.1},{"time":1563584400,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0.012,"precipProbability":0.24,"precipType":"rain","temperature":71.01,"apparentTemperature":71.01,"dewPoint":57.12,"humidity":0.62,"pressure":1008.15,"windSpeed":7.58,"windGust":13.98,"windBearing":8,"cloudCover":0.67,"uvIndex":1,"visibility":10,"ozone":339.9},{"time":1563588000,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0.006,"precipProbability":0.2,"precipType":"rain","temperature":68.78,"apparentTemperature":68.78,"dewPoint":57.17,"humidity":0.66,"pressure":1009.07,"windSpeed":6.69,"windGust":11.1,"windBearing":345,"cloudCover":0.55,"uvIndex":0,"visibility":10,"ozone":339.5},{"time":1563591600,"summary":"Partly Cloudy","icon":"partly-cloudy-day","precipIntensity":0.004,"precipProbability":0.16,"precipType":"rain","temperature":66.29,"apparentTemperature":66.29,"dewPoint":56.94,"humidity":0.72,"pressure":1009.98,"windSpeed":5.99,"windGust":9.34,"windBearing":322,"cloudCover":0.46,"uvIndex":0,"visibility":10,"ozone":339.4},{"time":1563595200,"summary":"Partly Cloudy","icon":"partly-cloudy-night","precipIntensity":0.004,"precipProbability":0.15,"precipType":"rain","temperature":64.26,"apparentTemperature":64.26,"dewPoint":56.1,"humidity":0.75,"pressure":1010.87,"windSpeed":5.66,"windGust":9.74,"windBearing":313,"cloudCover":0.42,"uvIndex":0,"visibility":10,"ozone":340}]},"daily":{"summary":"Rain throughout the week, with high temperatures rising to 84Â°F on Tuesday.","icon":"rain","data":[{"time":1563343200,"summary":"Rain until morning, starting again in the evening.","icon":"rain","sunriseTime":1563362902,"sunsetTime":1563422088,"moonPhase":0.54,"precipIntensity":0.0339,"precipIntensityMax":0.2483,"precipIntensityMaxTime":1563408000,"precipProbability":1,"precipType":"rain","temperatureHigh":74.52,"temperatureHighTime":1563400800,"temperatureLow":55.7,"temperatureLowTime":1563451200,"apparentTemperatureHigh":74.52,"apparentTemperatureHighTime":1563400800,"apparentTemperatureLow":55.7,"apparentTemperatureLowTime":1563451200,"dewPoint":53.5,"humidity":0.76,"pressure":1003.97,"windSpeed":5.49,"windGust":30.82,"windGustTime":1563418800,"windBearing":153,"cloudCover":0.4,"uvIndex":7,"uvIndexTime":1563390000,"visibility":8.875,"ozone":335.5,"temperatureMin":48.94,"temperatureMinTime":1563364800,"temperatureMax":74.52,"temperatureMaxTime":1563400800,"apparentTemperatureMin":48.94,"apparentTemperatureMinTime":1563364800,"apparentTemperatureMax":74.52,"apparentTemperatureMaxTime":1563400800},{"time":1563429600,"summary":"Light rain throughout the day.","icon":"rain","sunriseTime":1563449385,"sunsetTime":1563508415,"moonPhase":0.57,"precipIntensity":0.0259,"precipIntensityMax":0.0686,"precipIntensityMaxTime":1563483600,"precipProbability":1,"precipType":"rain","temperatureHigh":58.6,"temperatureHighTime":1563469200,"temperatureLow":52.92,"temperatureLowTime":1563534000,"apparentTemperatureHigh":58.6,"apparentTemperatureHighTime":1563469200,"apparentTemperatureLow":52.92,"apparentTemperatureLowTime":1563534000,"dewPoint":51.69,"humidity":0.82,"pressure":997.7,"windSpeed":13.01,"windGust":36.98,"windGustTime":1563480000,"windBearing":289,"cloudCover":0.85,"uvIndex":4,"uvIndexTime":1563476400,"visibility":7.864,"ozone":349.2,"temperatureMin":55.7,"temperatureMinTime":1563451200,"temperatureMax":58.6,"temperatureMaxTime":1563469200,"apparentTemperatureMin":55.7,"apparentTemperatureMinTime":1563451200,"apparentTemperatureMax":58.6,"apparentTemperatureMaxTime":1563469200},{"time":1563516000,"summary":"Light rain until evening.","icon":"rain","sunriseTime":1563535870,"sunsetTime":1563594739,"moonPhase":0.6,"precipIntensity":0.024,"precipIntensityMax":0.0559,"precipIntensityMaxTime":1563534000,
    #"precipProbability":0.95,"precipType":"rain","temperatureHigh":73.33,"temperatureHighTime":1563573600,"temperatureLow":54.61,"temperatureLowTime":1563620400,"apparentTemperatureHigh":73.33,"apparentTemperatureHighTime":1563573600,"apparentTemperatureLow":54.61,"apparentTemperatureLowTime":1563620400,"dewPoint":54.54,"humidity":0.76,"pressure":1005.12,"windSpeed":9.82,"windGust":29.84,"windGustTime":1563526800,"windBearing":340,"cloudCover":0.75,"uvIndex":4,"uvIndexTime":1563562800,"visibility":8.874,"ozone":338.4,"temperatureMin":52.92,"temperatureMinTime":1563534000,"temperatureMax":73.33,"temperatureMaxTime":1563573600,"apparentTemperatureMin":52.92,"apparentTemperatureMinTime":1563534000,"apparentTemperatureMax":73.33,"apparentTemperatureMaxTime":1563573600},{"time":1563602400,"summary":"Partly cloudy throughout the day.","icon":"rain","sunriseTime":1563622356,"sunsetTime":1563681061,"moonPhase":0.63,"precipIntensity":0.0024,"precipIntensityMax":0.0119,"precipIntensityMaxTime":1563602400,"precipProbability":0.4,"precipType":"rain","temperatureHigh":75.55,"temperatureHighTime":1563660000,"temperatureLow":56.44,"temperatureLowTime":1563710400,"apparentTemperatureHigh":75.55,"apparentTemperatureHighTime":1563660000,"apparentTemperatureLow":56.44,"apparentTemperatureLowTime":1563710400,"dewPoint":56.03,"humidity":0.73,"pressure":1015.68,"windSpeed":4.78,"windGust":12.26,"windGustTime":1563602400,"windBearing":263,"cloudCover":0.32,"uvIndex":6,"uvIndexTime":1563652800,"visibility":10,"ozone":338.8,"temperatureMin":54.61,"temperatureMinTime":1563620400,"temperatureMax":75.55,"temperatureMaxTime":1563660000,"apparentTemperatureMin":54.61,"apparentTemperatureMinTime":1563620400,"apparentTemperatureMax":75.55,"apparentTemperatureMaxTime":1563660000},{"time":1563688800,"summary":"Partly cloudy throughout the day.","icon":"clear-day","sunriseTime":1563708843,"sunsetTime":1563767380,"moonPhase":0.66,"precipIntensity":0.0002,"precipIntensityMax":0.0004,"precipIntensityMaxTime":1563768000,"precipProbability":0.01,"precipType":"rain","temperatureHigh":76.44,"temperatureHighTime":1563753600,"temperatureLow":58.44,"temperatureLowTime":1563796800,"apparentTemperatureHigh":76.44,"apparentTemperatureHighTime":1563753600,"apparentTemperatureLow":58.44,"apparentTemperatureLowTime":1563796800,"dewPoint":56.71,"humidity":0.7,"pressure":1018.33,"windSpeed":8.13,"windGust":26.42,"windGustTime":1563775200,"windBearing":157,"cloudCover":0.13,"uvIndex":7,"uvIndexTime":1563739200,"visibility":10,"ozone":318.7,"temperatureMin":56.44,"temperatureMinTime":1563710400,"temperatureMax":76.44,"temperatureMaxTime":1563753600,"apparentTemperatureMin":56.44,"apparentTemperatureMinTime":1563710400,"apparentTemperatureMax":76.44,"apparentTemperatureMaxTime":1563753600},{"time":1563775200,"summary":"Partly cloudy throughout the day.","icon":"clear-day","sunriseTime":1563795332,"sunsetTime":1563853696,"moonPhase":0.69,"precipIntensity":0.0001,"precipIntensityMax":0.0003,"precipIntensityMaxTime":1563775200,"precipProbability":0.01,"precipType":"rain","temperatureHigh":80.63,"temperatureHighTime":1563840000,"temperatureLow":60.19,"temperatureLowTime":1563879600,"apparentTemperatureHigh":81.85,"apparentTemperatureHighTime":1563840000,"apparentTemperatureLow":60.19,"apparentTemperatureLowTime":1563879600,"dewPoint":58.18,"humidity":0.66,"pressure":1015.51,"windSpeed":6.4,"windGust":26.45,"windGustTime":1563778800,"windBearing":157,"cloudCover":0.08,"uvIndex":8,"uvIndexTime":1563825600,"visibility":10,"ozone":302.1,"temperatureMin":58.44,"temperatureMinTime":1563796800,"temperatureMax":80.63,"temperatureMaxTime":1563840000,"apparentTemperatureMin":58.44,"apparentTemperatureMinTime":1563796800,"apparentTemperatureMax":81.85,"apparentTemperatureMaxTime":1563840000},{"time":1563861600,"summary":"Possible light rain overnight.","icon":"rain","sunriseTime":1563881823,"sunsetTime":1563940011,"moonPhase":0.72,"precipIntensity":0.0026,"precipIntensityMax":0.0364,"precipIntensityMaxTime":1563948000,"precipProbability":0.3,"precipType":"rain","temperatureHigh":83.62,"temperatureHighTime":1563922800,"temperatureLow":60.42,"temperatureLowTime":1563969600,"apparentTemperatureHigh":85.77,"apparentTemperatureHighTime":1563922800,"apparentTemperatureLow":60.44,"apparentTemperatureLowTime":1563969600,"dewPoint":62.42,"humidity":0.71,"pressure":1013.6,"windSpeed":3.21,"windGust":13.21,"windGustTime":1563948000,"windBearing":118,"cloudCover":0.06,"uvIndex":8,"uvIndexTime":1563912000,"visibility":10,"ozone":302,"temperatureMin":60.19,"temperatureMinTime":1563879600,"temperatureMax":83.62,"temperatureMaxTime":1563922800,"apparentTemperatureMin":60.19,"apparentTemperatureMinTime":1563879600,"apparentTemperatureMax":85.77,"apparentTemperatureMaxTime":1563922800},{"time":1563948000,"summary":"Possible light rain in the morning and overnight.","icon":"rain","sunriseTime":1563968314,"sunsetTime":1564026323,"moonPhase":0.75,"precipIntensity":0.003,"precipIntensityMax":0.0364,"precipIntensityMaxTime":1563948000,"precipProbability":0.43,"precipType":"rain","temperatureHigh":78.92,"temperatureHighTime":1564009200,"temperatureLow":63.82,"temperatureLowTime":1564056000,"apparentTemperatureHigh":79.16,"apparentTemperatureHighTime":1564009200,"apparentTemperatureLow":63.95,"apparentTemperatureLowTime":1564056000,"dewPoint":60.96,"humidity":0.72,"pressure":1016.46,"windSpeed":7.03,"windGust":21.86,"windGustTime":1564034400,"windBearing":2,"cloudCover":0.11,"uvIndex":7,"uvIndexTime":1563998400,"visibility":9.672,"ozone":299,"temperatureMin":60.42,"temperatureMinTime":1563969600,"temperatureMax":78.92,"temperatureMaxTime":1564009200,"apparentTemperatureMin":60.44,"apparentTemperatureMinTime":1563969600,"apparentTemperatureMax":79.16,"apparentTemperatureMaxTime":1564009200}]},"flags":{"sources":["ecpa","cmc","gfs","icon","isd","madis","nam","sref"],"nearest-station":5.07,"units":"us"},"offset":-6}
    #print(weatherStats) # Do json stuff with weatherStats
    print(type(a))
    print(a)
    print("hey")


    from_zone = tz.tzutc()
    my_zone = tz.tzlocal()
    for i in range(0,len(weatherStats.get("daily").get("data"))):
        sql_insert_replace_item = "insert or replace into " + key + """ (date, temp0, precip0, temp1, precip1, temp2, precip2,
                                        temp3, precip3, temp4, precip4, temp5, precip5, temp6, precip6, temp7, precip7 ) values ("""

        utc = datetime.utcfromtimestamp(weatherStats.get("daily").get("data")[i].get("time"))
        utc = utc.replace(tzinfo=from_zone)
        aDate = utc.astimezone(my_zone)

        temperature = weatherStats.get("daily").get("data")[i].get("temperatureHigh")
        precipChance = weatherStats.get("daily").get("data")[i].get("precipProbability")
        precipType = weatherStats.get("daily").get("data")[i].get("precipType")

    #  print("New " + str(i))
    #  print(aDate)
    #  print(aDate.day)
    #  print(aDate.month)
    #  print(aDate.year)
    #  print(temperature)
    #  print(precipChance)
    #  print(precipType)

        dateString = str(aDate.year) + "-" + str(aDate.month).zfill(2) + "-" + str(aDate.day).zfill(2)
        print(dateString)
        dateString = "\""+dateString+"\""

        #sql_insert_replace_item = sql_insert_replace_item + "(select date from loc where date = " + dateString + "),"
        sql_insert_replace_item = sql_insert_replace_item + dateString + ","
        r = i
        while (r > 0):
            sql_insert_replace_item = sql_insert_replace_item + "null,"
            sql_insert_replace_item = sql_insert_replace_item + "null,"
            r = r - 1
        sql_insert_replace_item = sql_insert_replace_item + str(temperature)+","
        sql_insert_replace_item = sql_insert_replace_item + str(precipChance)+","
        r = i + 1
        while (r <= 7):
            sql_insert_replace_item = sql_insert_replace_item + "(select temp"+str(r)+" from " + key + " where date = " + dateString + "),"
            sql_insert_replace_item = sql_insert_replace_item + "(select precip"+str(r)+" from " + key + " where date = " + dateString + "),"
            r = r + 1
        sql_insert_replace_item = sql_insert_replace_item[0:-1]
        sql_insert_replace_item = sql_insert_replace_item + ");"
        print(sql_insert_replace_item)
        c.execute(sql_insert_replace_item)

    for row in c.execute("SELECT * FROM " + key):
        print(row)
    print(c.execute("SELECT * FROM " + key + " where date = null"))


conn.commit()
conn.close()
